!function(){"use strict";const e=(e,t,...r)=>new Promise(((n,o)=>{r.push((e=>{chrome.runtime.lastError?o(chrome.runtime.lastError):n(e)})),e[t](...r)})),t={onChanged:e=>chrome.storage.sync.onChanged(e),clear:()=>e(chrome.storage.sync,"clear"),get:t=>e(chrome.storage.sync,"get",t),getBytesInUse:t=>e(chrome.storage.sync,"getBytesInUse",t),remove:t=>e(chrome.storage.sync,"remove",t),set:t=>e(chrome.storage.sync,"set",t)},r=()=>{},n=e=>"number"==typeof e&&Number.isFinite(e),o=Array.isArray,i=e=>"object"==typeof e&&!!e&&!o(e),a=e=>"function"==typeof e,u=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),c=()=>{chrome.runtime.lastError},s=e=>{null!=e&&e.id&&((e.url||"").match(/^https:\/\/.*duolingo\.com\//)?chrome.pageAction.show(e.id,c):chrome.pageAction.hide(e.id,c),chrome.runtime.lastError&&setTimeout((()=>s(e)),50))},l=(e,t)=>chrome.tabs.get(e,(r=>{var n;return"Tabs cannot be edited right now (user may be dragging a tab)."!==(null===(n=chrome.runtime.lastError)||void 0===n?void 0:n.message)?t(r):setTimeout((()=>l(e,t)),100)})),f=e=>`__duo-toolbox__-${e}`,d=f("global_variables"),v=(e,t,r)=>{const n=t(((e,t)=>(i(window[d])||(window[d]={}),u(window[d],e)?window[d][e]:t))(e,r));return((e,t)=>{i(window[d])||(window[d]={}),window[d][e]=t})(e,n),n},h=f("original_function"),p=f("override_version"),y=(e,t,n,o=1)=>((e,t,r,n,o=1)=>{u(window,e)&&t(window[e])?r(window[e]):v("pending_global_listeners",((i={})=>{var a;if(!i[e]){i[e]={};let r=window[e];Object.defineProperty(window,e,{get:()=>r,set:n=>{t(n)?(Object.defineProperty(window,e,{value:n,configurable:!0,enumerable:!0,writable:!0}),Object.values(i[e]).forEach((e=>e.callback(n)))):r=n},configurable:!0})}return o>(Number(null===(a=i[e][n])||void 0===a?void 0:a.version)||0)&&(i[e][n]={callback:r,version:o}),i}))})(e,a,(e=>((e,t,n,o=1)=>{var a;if(i(e)&&o>(Number(null===(a=e[t])||void 0===a?void 0:a[p])||0)){var u;const i=(null===(u=e[t])||void 0===u?void 0:u[h])||e[t]||r;e[t]=n(i),e[t][h]=i,e[t][p]=o}})(null==e?void 0:e.prototype,t,n,o)),`instance_method:${t}`,o),_=f("action_request"),b=f("background_event_notification");var g="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},m={exports:{}};!function(e,t){var r="__lodash_hash_undefined__",n=9007199254740991,o="[object Arguments]",i="[object Function]",a="[object Object]",u=/^\[object .+?Constructor\]$/,c=/^(?:0|[1-9]\d*)$/,s={};s["[object Float32Array]"]=s["[object Float64Array]"]=s["[object Int8Array]"]=s["[object Int16Array]"]=s["[object Int32Array]"]=s["[object Uint8Array]"]=s["[object Uint8ClampedArray]"]=s["[object Uint16Array]"]=s["[object Uint32Array]"]=!0,s[o]=s["[object Array]"]=s["[object ArrayBuffer]"]=s["[object Boolean]"]=s["[object DataView]"]=s["[object Date]"]=s["[object Error]"]=s[i]=s["[object Map]"]=s["[object Number]"]=s[a]=s["[object RegExp]"]=s["[object Set]"]=s["[object String]"]=s["[object WeakMap]"]=!1;var l="object"==typeof g&&g&&g.Object===Object&&g,f="object"==typeof self&&self&&self.Object===Object&&self,d=l||f||Function("return this")(),v=t&&!t.nodeType&&t,h=v&&e&&!e.nodeType&&e,p=h&&h.exports===v,y=p&&l.process,_=function(){try{var e=h&&h.require&&h.require("util").types;return e||y&&y.binding&&y.binding("util")}catch(e){}}(),b=_&&_.isTypedArray;function m(e,t,r){switch(r.length){case 0:return e.call(t);case 1:return e.call(t,r[0]);case 2:return e.call(t,r[0],r[1]);case 3:return e.call(t,r[0],r[1],r[2])}return e.apply(t,r)}var w,j,O,A=Array.prototype,z=Function.prototype,x=Object.prototype,E=d["__core-js_shared__"],K=z.toString,$=x.hasOwnProperty,V=(w=/[^.]+$/.exec(E&&E.keys&&E.keys.IE_PROTO||""))?"Symbol(src)_1."+w:"",q=x.toString,P=K.call(Object),U=RegExp("^"+K.call($).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),k=p?d.Buffer:void 0,T=d.Symbol,M=d.Uint8Array,R=k?k.allocUnsafe:void 0,S=(j=Object.getPrototypeOf,O=Object,function(e){return j(O(e))}),I=Object.create,F=x.propertyIsEnumerable,B=A.splice,L=T?T.toStringTag:void 0,N=function(){try{var e=pe(Object,"defineProperty");return e({},"",{}),e}catch(e){}}(),C=k?k.isBuffer:void 0,D=Math.max,H=Date.now,Q=pe(d,"Map"),G=pe(Object,"create"),W=function(){function e(){}return function(t){if(!Ee(t))return{};if(I)return I(t);e.prototype=t;var r=new e;return e.prototype=void 0,r}}();function J(e){var t=-1,r=null==e?0:e.length;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}function X(e){var t=-1,r=null==e?0:e.length;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}function Y(e){var t=-1,r=null==e?0:e.length;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}function Z(e){var t=this.__data__=new X(e);this.size=t.size}function ee(e,t){var r=je(e),n=!r&&we(e),o=!r&&!n&&Ae(e),i=!r&&!n&&!o&&$e(e),a=r||n||o||i,u=a?function(e,t){for(var r=-1,n=Array(e);++r<e;)n[r]=t(r);return n}(e.length,String):[],c=u.length;for(var s in e)!t&&!$.call(e,s)||a&&("length"==s||o&&("offset"==s||"parent"==s)||i&&("buffer"==s||"byteLength"==s||"byteOffset"==s)||ye(s,c))||u.push(s);return u}function te(e,t,r){(void 0!==r&&!me(e[t],r)||void 0===r&&!(t in e))&&oe(e,t,r)}function re(e,t,r){var n=e[t];$.call(e,t)&&me(n,r)&&(void 0!==r||t in e)||oe(e,t,r)}function ne(e,t){for(var r=e.length;r--;)if(me(e[r][0],t))return r;return-1}function oe(e,t,r){"__proto__"==t&&N?N(e,t,{configurable:!0,enumerable:!0,value:r,writable:!0}):e[t]=r}J.prototype.clear=function(){this.__data__=G?G(null):{},this.size=0},J.prototype.delete=function(e){var t=this.has(e)&&delete this.__data__[e];return this.size-=t?1:0,t},J.prototype.get=function(e){var t=this.__data__;if(G){var n=t[e];return n===r?void 0:n}return $.call(t,e)?t[e]:void 0},J.prototype.has=function(e){var t=this.__data__;return G?void 0!==t[e]:$.call(t,e)},J.prototype.set=function(e,t){var n=this.__data__;return this.size+=this.has(e)?0:1,n[e]=G&&void 0===t?r:t,this},X.prototype.clear=function(){this.__data__=[],this.size=0},X.prototype.delete=function(e){var t=this.__data__,r=ne(t,e);return!(r<0)&&(r==t.length-1?t.pop():B.call(t,r,1),--this.size,!0)},X.prototype.get=function(e){var t=this.__data__,r=ne(t,e);return r<0?void 0:t[r][1]},X.prototype.has=function(e){return ne(this.__data__,e)>-1},X.prototype.set=function(e,t){var r=this.__data__,n=ne(r,e);return n<0?(++this.size,r.push([e,t])):r[n][1]=t,this},Y.prototype.clear=function(){this.size=0,this.__data__={hash:new J,map:new(Q||X),string:new J}},Y.prototype.delete=function(e){var t=he(this,e).delete(e);return this.size-=t?1:0,t},Y.prototype.get=function(e){return he(this,e).get(e)},Y.prototype.has=function(e){return he(this,e).has(e)},Y.prototype.set=function(e,t){var r=he(this,e),n=r.size;return r.set(e,t),this.size+=r.size==n?0:1,this},Z.prototype.clear=function(){this.__data__=new X,this.size=0},Z.prototype.delete=function(e){var t=this.__data__,r=t.delete(e);return this.size=t.size,r},Z.prototype.get=function(e){return this.__data__.get(e)},Z.prototype.has=function(e){return this.__data__.has(e)},Z.prototype.set=function(e,t){var r=this.__data__;if(r instanceof X){var n=r.__data__;if(!Q||n.length<199)return n.push([e,t]),this.size=++r.size,this;r=this.__data__=new Y(n)}return r.set(e,t),this.size=r.size,this};var ie,ae=function(e,t,r){for(var n=-1,o=Object(e),i=r(e),a=i.length;a--;){var u=i[ie?a:++n];if(!1===t(o[u],u,o))break}return e};function ue(e){return null==e?void 0===e?"[object Undefined]":"[object Null]":L&&L in Object(e)?function(e){var t=$.call(e,L),r=e[L];try{e[L]=void 0;var n=!0}catch(e){}var o=q.call(e);n&&(t?e[L]=r:delete e[L]);return o}(e):function(e){return q.call(e)}(e)}function ce(e){return Ke(e)&&ue(e)==o}function se(e){return!(!Ee(e)||function(e){return!!V&&V in e}(e))&&(ze(e)?U:u).test(function(e){if(null!=e){try{return K.call(e)}catch(e){}try{return e+""}catch(e){}}return""}(e))}function le(e){if(!Ee(e))return function(e){var t=[];if(null!=e)for(var r in Object(e))t.push(r);return t}(e);var t=_e(e),r=[];for(var n in e)("constructor"!=n||!t&&$.call(e,n))&&r.push(n);return r}function fe(e,t,r,n,o){e!==t&&ae(t,(function(i,u){if(o||(o=new Z),Ee(i))!function(e,t,r,n,o,i,u){var c=be(e,r),s=be(t,r),l=u.get(s);if(l)return void te(e,r,l);var f=i?i(c,s,r+"",e,t,u):void 0,d=void 0===f;if(d){var v=je(s),h=!v&&Ae(s),p=!v&&!h&&$e(s);f=s,v||h||p?je(c)?f=c:Ke(m=c)&&Oe(m)?f=function(e,t){var r=-1,n=e.length;t||(t=Array(n));for(;++r<n;)t[r]=e[r];return t}(c):h?(d=!1,f=function(e,t){if(t)return e.slice();var r=e.length,n=R?R(r):new e.constructor(r);return e.copy(n),n}(s,!0)):p?(d=!1,y=s,_=!0?(b=y.buffer,g=new b.constructor(b.byteLength),new M(g).set(new M(b)),g):y.buffer,f=new y.constructor(_,y.byteOffset,y.length)):f=[]:function(e){if(!Ke(e)||ue(e)!=a)return!1;var t=S(e);if(null===t)return!0;var r=$.call(t,"constructor")&&t.constructor;return"function"==typeof r&&r instanceof r&&K.call(r)==P}(s)||we(s)?(f=c,we(c)?f=function(e){return function(e,t,r,n){var o=!r;r||(r={});var i=-1,a=t.length;for(;++i<a;){var u=t[i],c=n?n(r[u],e[u],u,r,e):void 0;void 0===c&&(c=e[u]),o?oe(r,u,c):re(r,u,c)}return r}(e,Ve(e))}(c):Ee(c)&&!ze(c)||(f=function(e){return"function"!=typeof e.constructor||_e(e)?{}:W(S(e))}(s))):d=!1}var y,_,b,g;var m;d&&(u.set(s,f),o(f,s,n,i,u),u.delete(s));te(e,r,f)}(e,t,u,r,fe,n,o);else{var c=n?n(be(e,u),i,u+"",e,t,o):void 0;void 0===c&&(c=i),te(e,u,c)}}),Ve)}function de(e,t){return ge(function(e,t,r){return t=D(void 0===t?e.length-1:t,0),function(){for(var n=arguments,o=-1,i=D(n.length-t,0),a=Array(i);++o<i;)a[o]=n[t+o];o=-1;for(var u=Array(t+1);++o<t;)u[o]=n[o];return u[t]=r(a),m(e,this,u)}}(e,t,Ue),e+"")}var ve=N?function(e,t){return N(e,"toString",{configurable:!0,enumerable:!1,value:(r=t,function(){return r}),writable:!0});var r}:Ue;function he(e,t){var r,n,o=e.__data__;return("string"==(n=typeof(r=t))||"number"==n||"symbol"==n||"boolean"==n?"__proto__"!==r:null===r)?o["string"==typeof t?"string":"hash"]:o.map}function pe(e,t){var r=function(e,t){return null==e?void 0:e[t]}(e,t);return se(r)?r:void 0}function ye(e,t){var r=typeof e;return!!(t=null==t?n:t)&&("number"==r||"symbol"!=r&&c.test(e))&&e>-1&&e%1==0&&e<t}function _e(e){var t=e&&e.constructor;return e===("function"==typeof t&&t.prototype||x)}function be(e,t){if(("constructor"!==t||"function"!=typeof e[t])&&"__proto__"!=t)return e[t]}var ge=function(e){var t=0,r=0;return function(){var n=H(),o=16-(n-r);if(r=n,o>0){if(++t>=800)return arguments[0]}else t=0;return e.apply(void 0,arguments)}}(ve);function me(e,t){return e===t||e!=e&&t!=t}var we=ce(function(){return arguments}())?ce:function(e){return Ke(e)&&$.call(e,"callee")&&!F.call(e,"callee")},je=Array.isArray;function Oe(e){return null!=e&&xe(e.length)&&!ze(e)}var Ae=C||function(){return!1};function ze(e){if(!Ee(e))return!1;var t=ue(e);return t==i||"[object GeneratorFunction]"==t||"[object AsyncFunction]"==t||"[object Proxy]"==t}function xe(e){return"number"==typeof e&&e>-1&&e%1==0&&e<=n}function Ee(e){var t=typeof e;return null!=e&&("object"==t||"function"==t)}function Ke(e){return null!=e&&"object"==typeof e}var $e=b?function(e){return function(t){return e(t)}}(b):function(e){return Ke(e)&&xe(e.length)&&!!s[ue(e)]};function Ve(e){return Oe(e)?ee(e,!0):le(e)}var qe,Pe=(qe=function(e,t,r){fe(e,t,r)},de((function(e,t){var r=-1,n=t.length,o=n>1?t[n-1]:void 0,i=n>2?t[2]:void 0;for(o=qe.length>3&&"function"==typeof o?(n--,o):void 0,i&&function(e,t,r){if(!Ee(r))return!1;var n=typeof t;return!!("number"==n?Oe(r)&&ye(t,r.length):"string"==n&&t in r)&&me(r[t],e)}(t[0],t[1],i)&&(o=n<3?void 0:o,n=1),e=Object(e);++r<n;){var a=t[r];a&&qe(e,a,r,o)}return e})));function Ue(e){return e}e.exports=Pe}(m,m.exports);var w=m.exports;const j="normal",O="rate",A="volume",z=f("forced_setting"),x=e=>i(e)&&!!e[z],E=e=>e.value,K=e=>({[z]:!0,value:e}),$=(e,t)=>O===e&&n(t)||A===e&&t>=0&&t<=1,V=(e,t)=>((e,t,r,n=1)=>{if(!i(e))return;const o=f(`${t}_override_version`);n>(Number(e[o])||0)&&Object.defineProperty(e,t,r(Object.getOwnPropertyDescriptor(e,t)))})(HTMLMediaElement,t,(t=>({...t,set:function(r){const o=U[e];n(r)?(this[o.originalValueKey]=r,u(this,o.valueKey)&&(r=this[o.isRelativeKey]?T(e,r*this[o.valueKey]):this[o.valueKey])):x(r)&&(r=E(r)),n(r)&&(this[o.listenerValueKey]=r),t.set.call(this,r)}}))),q=(e,t)=>y("Howl",t,(r=>function(){const n=this,o=arguments,i=U[e];let a=!1;const c=n._queue.length;(1===o.length||2===o.length&&void 0===o[1])&&-1===n._getSoundIds().indexOf(o[0])&&(x(o[0])?(a=!0,o[0]=E(o[0])):$(e,o[0])&&(n[i.originalValueKey]=o[0],u(n,i.valueKey)&&(a=!0,n[i.isRelativeKey]?o[0]=T(e,o[0]*n[i.valueKey]):o[0]=n[i.valueKey])),a&&(n[i.listenerValueKey]=o[0]));const s=r.apply(n,arguments);return a&&c<n._queue.length&&(n._queue[n._queue.length-1].action=function(){o[0]=K(o[0]),n[t](...o)}),s})),P=(e,t,r,n)=>({...n,functions:{audio:{applyOverride:()=>V(e,r),getter:e=>e[t],setter:(e,r)=>e[t]=r,hasQueuedUpdate:()=>!1},howler:{applyOverride:()=>q(e,r),getter:e=>e[r](),setter:(e,t)=>e[r](t),hasQueuedUpdate:e=>e._queue.find((e=>e.event===r))}},priorityKey:f(`${e}_priority`),isRelativeKey:f(`${e}_is_relative`),valueKey:f(`forced_${e}_value`),originalValueKey:f(`original_${e}_value`),listenerValueKey:f(`${e}_value`)}),U={[O]:P(O,"playbackRate","rate",{minValue:.5,maxValue:4,defaultValue:1}),[A]:P(A,"volume","volume",{minValue:0,maxValue:1,defaultValue:1})},k=e=>(e=>{const t=U[e];if(!t)throw new Error(`Unknown sound setting: "${e}".`);return t})(e).defaultValue,T=(e,t)=>U[e]?Math.max(U[e].minValue,Math.min(t,U[e].maxValue)):t,M=["listening_challenge","other_challenge","story","forum_discussion","dictionary","characters","unknown"],R="default",S="main",I=[A,O],F=e=>A===e,B=(e,t=null,r=null)=>({effect:{[j]:t},tts_sentence:{[j]:t,slow:t},tts_word:{[j]:t},tts_morpheme:{[j]:t},unknown:{[j]:t},...F(e)?{[S]:r}:{}}),L=(e,t)=>Object.fromEntries([[R,B(e,{value:t,isRelative:!0},{value:t})],...M.map((t=>[t,B(e)]))]),N=Object.fromEntries(I.map((e=>[e,L(e,k(e))]))),C=(e,t,r,n,o,a)=>{return u=r,c=n,i(N.volume.default[u][c])?w({},e,{[t]:{[null!=o?o:R]:{[r]:{[n]:a}}}}):e;var u,c},D=e=>I.includes(e.setting)&&u(e,"value")&&(!e.context||M.includes(e.context)),H=(e,t)=>{if(!D(t))return e;const{setting:r,context:n,value:o,soundType:i=null,soundSpeed:a=null}=t;return i&&a?C(e,r,i,a,n,o):((e,t,r,n)=>F(t)?w({},e,{[t]:{[null!=r?r:R]:{[S]:n}}}):e)(e,r,n,o)},Q="profiles",G=async(e,r)=>{if(i(e)&&i(e.updateRequest)&&D(e.updateRequest)){const i=(await t.get(Q)).profiles||{};i[0]=H(i[0]||N,e.updateRequest),await t.set({[Q]:i}),r(i[0]),n="current_profile_changed",o=i[0],chrome.runtime.sendMessage({type:b,event:n,value:o}),chrome.tabs.query({url:"https://*.duolingo.com/*"},(e=>e.forEach((e=>chrome.tabs.sendMessage(e.id,{type:b,event:n,value:o})))))}var n,o};var W;W=async(e,r,n,o)=>{switch(e){case"get_current_profile":await(async e=>{e(((await t.get(Q)).profiles||{})[0]||N)})(o);break;case"update_current_profile":await G(r,o)}},chrome.runtime.onMessage.addListener(((e,t,r)=>{if(_===e.type){let n=!1;const o=e=>{n=!0,r({type:"success",value:e})},i=e=>{n=!0,r({type:"failure",error:e})};try{Promise.resolve(W(e.action,e.value,t,o,i)).then((()=>{if(!n)throw new Error(`Could not handle action request: "${e.action}".`)})).catch((e=>{n||i(e)}))}catch(e){!n&&i(e)}return!0}})),chrome.tabs.onUpdated.addListener(((e,t)=>e&&(null!=t&&t.id?s(t):l(e,s)))),chrome.tabs.onActivated.addListener((({tabId:e})=>e&&l(e,s)))}();
