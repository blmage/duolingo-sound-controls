!function(){"use strict";const e=(e,t,...r)=>new Promise(((n,o)=>{r.push((e=>{chrome.runtime.lastError?o(chrome.runtime.lastError):n(e)})),e[t](...r)})),t={onChanged:e=>chrome.storage.sync.onChanged(e),clear:()=>e(chrome.storage.sync,"clear"),get:t=>e(chrome.storage.sync,"get",t),getBytesInUse:t=>e(chrome.storage.sync,"getBytesInUse",t),remove:t=>e(chrome.storage.sync,"remove",t),set:t=>e(chrome.storage.sync,"set",t)},r=()=>{},n=e=>"number"==typeof e&&Number.isFinite(e),o=Array.isArray,i=e=>"object"==typeof e&&!!e&&!o(e),a=e=>"function"==typeof e,u=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),c=()=>{chrome.runtime.lastError},l=e=>{null!=e&&e.id&&((e.url||"").match(/^https:\/\/.*duolingo\.com\//)?chrome.pageAction.show(e.id,c):chrome.pageAction.hide(e.id,c),chrome.runtime.lastError&&setTimeout((()=>l(e)),50))},s=(e,t)=>chrome.tabs.get(e,(r=>{var n;return"Tabs cannot be edited right now (user may be dragging a tab)."!==(null===(n=chrome.runtime.lastError)||void 0===n?void 0:n.message)?t(r):setTimeout((()=>s(e,t)),100)})),f=e=>`__duo-toolbox__-${e}`,d=f("global_variables"),h=(e,t,r)=>{const n=t(((e,t)=>(i(window[d])||(window[d]={}),u(window[d],e)?window[d][e]:t))(e,r));return((e,t)=>{i(window[d])||(window[d]={}),window[d][e]=t})(e,n),n},v=f("original_function"),p=f("override_version"),y=(e,t,n,o=1)=>((e,t,r,n,o=1)=>{u(window,e)&&t(window[e])?r(window[e]):h("pending_global_listeners",((i={})=>{var a;if(!i[e]){i[e]={};let r=window[e];Object.defineProperty(window,e,{get:()=>r,set:n=>{t(n)?(Object.defineProperty(window,e,{value:n,configurable:!0,enumerable:!0,writable:!0}),Object.values(i[e]).forEach((e=>e.callback(n)))):r=n},configurable:!0})}return o>(Number(null===(a=i[e][n])||void 0===a?void 0:a.version)||0)&&(i[e][n]={callback:r,version:o}),i}))})(e,a,(e=>((e,t,n,o=1)=>{var a;if(i(e)&&o>(Number(null===(a=e[t])||void 0===a?void 0:a[p])||0)){var u;const i=(null===(u=e[t])||void 0===u?void 0:u[v])||e[t]||r;e[t]=n(i),e[t][v]=i,e[t][p]=o}})(null==e?void 0:e.prototype,t,n,o)),`instance_method:${t}`,o),_=f("action_request"),b=f("background_event_notification");var g="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};var m,w,j,O=(m=function(e,t){var r="__lodash_hash_undefined__",n=9007199254740991,o="[object Arguments]",i="[object Function]",a="[object Object]",u=/^\[object .+?Constructor\]$/,c=/^(?:0|[1-9]\d*)$/,l={};l["[object Float32Array]"]=l["[object Float64Array]"]=l["[object Int8Array]"]=l["[object Int16Array]"]=l["[object Int32Array]"]=l["[object Uint8Array]"]=l["[object Uint8ClampedArray]"]=l["[object Uint16Array]"]=l["[object Uint32Array]"]=!0,l[o]=l["[object Array]"]=l["[object ArrayBuffer]"]=l["[object Boolean]"]=l["[object DataView]"]=l["[object Date]"]=l["[object Error]"]=l[i]=l["[object Map]"]=l["[object Number]"]=l[a]=l["[object RegExp]"]=l["[object Set]"]=l["[object String]"]=l["[object WeakMap]"]=!1;var s="object"==typeof g&&g&&g.Object===Object&&g,f="object"==typeof self&&self&&self.Object===Object&&self,d=s||f||Function("return this")(),h=t&&!t.nodeType&&t,v=h&&e&&!e.nodeType&&e,p=v&&v.exports===h,y=p&&s.process,_=function(){try{var e=v&&v.require&&v.require("util").types;return e||y&&y.binding&&y.binding("util")}catch(e){}}(),b=_&&_.isTypedArray;function m(e,t,r){switch(r.length){case 0:return e.call(t);case 1:return e.call(t,r[0]);case 2:return e.call(t,r[0],r[1]);case 3:return e.call(t,r[0],r[1],r[2])}return e.apply(t,r)}var w,j,O,A=Array.prototype,z=Function.prototype,x=Object.prototype,E=d["__core-js_shared__"],K=z.toString,$=x.hasOwnProperty,V=(w=/[^.]+$/.exec(E&&E.keys&&E.keys.IE_PROTO||""))?"Symbol(src)_1."+w:"",q=x.toString,P=K.call(Object),U=RegExp("^"+K.call($).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),k=p?d.Buffer:void 0,T=d.Symbol,M=d.Uint8Array,R=k?k.allocUnsafe:void 0,S=(j=Object.getPrototypeOf,O=Object,function(e){return j(O(e))}),I=Object.create,F=x.propertyIsEnumerable,B=A.splice,L=T?T.toStringTag:void 0,N=function(){try{var e=pe(Object,"defineProperty");return e({},"",{}),e}catch(e){}}(),C=k?k.isBuffer:void 0,D=Math.max,H=Date.now,Q=pe(d,"Map"),G=pe(Object,"create"),W=function(){function e(){}return function(t){if(!Ee(t))return{};if(I)return I(t);e.prototype=t;var r=new e;return e.prototype=void 0,r}}();function J(e){var t=-1,r=null==e?0:e.length;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}function X(e){var t=-1,r=null==e?0:e.length;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}function Y(e){var t=-1,r=null==e?0:e.length;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}function Z(e){var t=this.__data__=new X(e);this.size=t.size}function ee(e,t){var r=je(e),n=!r&&we(e),o=!r&&!n&&Ae(e),i=!r&&!n&&!o&&$e(e),a=r||n||o||i,u=a?function(e,t){for(var r=-1,n=Array(e);++r<e;)n[r]=t(r);return n}(e.length,String):[],c=u.length;for(var l in e)!t&&!$.call(e,l)||a&&("length"==l||o&&("offset"==l||"parent"==l)||i&&("buffer"==l||"byteLength"==l||"byteOffset"==l)||ye(l,c))||u.push(l);return u}function te(e,t,r){(void 0!==r&&!me(e[t],r)||void 0===r&&!(t in e))&&oe(e,t,r)}function re(e,t,r){var n=e[t];$.call(e,t)&&me(n,r)&&(void 0!==r||t in e)||oe(e,t,r)}function ne(e,t){for(var r=e.length;r--;)if(me(e[r][0],t))return r;return-1}function oe(e,t,r){"__proto__"==t&&N?N(e,t,{configurable:!0,enumerable:!0,value:r,writable:!0}):e[t]=r}J.prototype.clear=function(){this.__data__=G?G(null):{},this.size=0},J.prototype.delete=function(e){var t=this.has(e)&&delete this.__data__[e];return this.size-=t?1:0,t},J.prototype.get=function(e){var t=this.__data__;if(G){var n=t[e];return n===r?void 0:n}return $.call(t,e)?t[e]:void 0},J.prototype.has=function(e){var t=this.__data__;return G?void 0!==t[e]:$.call(t,e)},J.prototype.set=function(e,t){var n=this.__data__;return this.size+=this.has(e)?0:1,n[e]=G&&void 0===t?r:t,this},X.prototype.clear=function(){this.__data__=[],this.size=0},X.prototype.delete=function(e){var t=this.__data__,r=ne(t,e);return!(r<0||(r==t.length-1?t.pop():B.call(t,r,1),--this.size,0))},X.prototype.get=function(e){var t=this.__data__,r=ne(t,e);return r<0?void 0:t[r][1]},X.prototype.has=function(e){return ne(this.__data__,e)>-1},X.prototype.set=function(e,t){var r=this.__data__,n=ne(r,e);return n<0?(++this.size,r.push([e,t])):r[n][1]=t,this},Y.prototype.clear=function(){this.size=0,this.__data__={hash:new J,map:new(Q||X),string:new J}},Y.prototype.delete=function(e){var t=ve(this,e).delete(e);return this.size-=t?1:0,t},Y.prototype.get=function(e){return ve(this,e).get(e)},Y.prototype.has=function(e){return ve(this,e).has(e)},Y.prototype.set=function(e,t){var r=ve(this,e),n=r.size;return r.set(e,t),this.size+=r.size==n?0:1,this},Z.prototype.clear=function(){this.__data__=new X,this.size=0},Z.prototype.delete=function(e){var t=this.__data__,r=t.delete(e);return this.size=t.size,r},Z.prototype.get=function(e){return this.__data__.get(e)},Z.prototype.has=function(e){return this.__data__.has(e)},Z.prototype.set=function(e,t){var r=this.__data__;if(r instanceof X){var n=r.__data__;if(!Q||n.length<199)return n.push([e,t]),this.size=++r.size,this;r=this.__data__=new Y(n)}return r.set(e,t),this.size=r.size,this};var ie,ae=function(e,t,r){for(var n=-1,o=Object(e),i=r(e),a=i.length;a--;){var u=i[ie?a:++n];if(!1===t(o[u],u,o))break}return e};function ue(e){return null==e?void 0===e?"[object Undefined]":"[object Null]":L&&L in Object(e)?function(e){var t=$.call(e,L),r=e[L];try{e[L]=void 0;var n=!0}catch(e){}var o=q.call(e);return n&&(t?e[L]=r:delete e[L]),o}(e):function(e){return q.call(e)}(e)}function ce(e){return Ke(e)&&ue(e)==o}function le(e){return!(!Ee(e)||function(e){return!!V&&V in e}(e))&&(ze(e)?U:u).test(function(e){if(null!=e){try{return K.call(e)}catch(e){}try{return e+""}catch(e){}}return""}(e))}function se(e){if(!Ee(e))return function(e){var t=[];if(null!=e)for(var r in Object(e))t.push(r);return t}(e);var t=_e(e),r=[];for(var n in e)("constructor"!=n||!t&&$.call(e,n))&&r.push(n);return r}function fe(e,t,r,n,o){e!==t&&ae(t,(function(i,u){if(o||(o=new Z),Ee(i))!function(e,t,r,n,o,i,u){var c=be(e,r),l=be(t,r),s=u.get(l);if(s)te(e,r,s);else{var f,d,h,v,p,y=i?i(c,l,r+"",e,t,u):void 0,_=void 0===y;if(_){var b=je(l),g=!b&&Ae(l),m=!b&&!g&&$e(l);y=l,b||g||m?je(c)?y=c:Ke(p=c)&&Oe(p)?y=function(e,t){var r=-1,n=e.length;for(t||(t=Array(n));++r<n;)t[r]=e[r];return t}(c):g?(_=!1,y=function(e,t){if(t)return e.slice();var r=e.length,n=R?R(r):new e.constructor(r);return e.copy(n),n}(l,!0)):m?(_=!1,h=(f=l).buffer,v=new h.constructor(h.byteLength),new M(v).set(new M(h)),d=v,y=new f.constructor(d,f.byteOffset,f.length)):y=[]:function(e){if(!Ke(e)||ue(e)!=a)return!1;var t=S(e);if(null===t)return!0;var r=$.call(t,"constructor")&&t.constructor;return"function"==typeof r&&r instanceof r&&K.call(r)==P}(l)||we(l)?(y=c,we(c)?y=function(e){return function(e,t,r,n){var o=!r;r||(r={});for(var i=-1,a=t.length;++i<a;){var u=t[i],c=n?n(r[u],e[u],u,r,e):void 0;void 0===c&&(c=e[u]),o?oe(r,u,c):re(r,u,c)}return r}(e,Ve(e))}(c):Ee(c)&&!ze(c)||(y=function(e){return"function"!=typeof e.constructor||_e(e)?{}:W(S(e))}(l))):_=!1}_&&(u.set(l,y),o(y,l,n,i,u),u.delete(l)),te(e,r,y)}}(e,t,u,r,fe,n,o);else{var c=n?n(be(e,u),i,u+"",e,t,o):void 0;void 0===c&&(c=i),te(e,u,c)}}),Ve)}function de(e,t){return ge(function(e,t,r){return t=D(void 0===t?e.length-1:t,0),function(){for(var n=arguments,o=-1,i=D(n.length-t,0),a=Array(i);++o<i;)a[o]=n[t+o];o=-1;for(var u=Array(t+1);++o<t;)u[o]=n[o];return u[t]=r(a),m(e,this,u)}}(e,t,Ue),e+"")}var he=N?function(e,t){return N(e,"toString",{configurable:!0,enumerable:!1,value:(r=t,function(){return r}),writable:!0});var r}:Ue;function ve(e,t){var r,n,o=e.__data__;return("string"==(n=typeof(r=t))||"number"==n||"symbol"==n||"boolean"==n?"__proto__"!==r:null===r)?o["string"==typeof t?"string":"hash"]:o.map}function pe(e,t){var r=function(e,t){return null==e?void 0:e[t]}(e,t);return le(r)?r:void 0}function ye(e,t){var r=typeof e;return!!(t=null==t?n:t)&&("number"==r||"symbol"!=r&&c.test(e))&&e>-1&&e%1==0&&e<t}function _e(e){var t=e&&e.constructor;return e===("function"==typeof t&&t.prototype||x)}function be(e,t){if(("constructor"!==t||"function"!=typeof e[t])&&"__proto__"!=t)return e[t]}var ge=function(e){var t=0,r=0;return function(){var n=H(),o=16-(n-r);if(r=n,o>0){if(++t>=800)return arguments[0]}else t=0;return e.apply(void 0,arguments)}}(he);function me(e,t){return e===t||e!=e&&t!=t}var we=ce(function(){return arguments}())?ce:function(e){return Ke(e)&&$.call(e,"callee")&&!F.call(e,"callee")},je=Array.isArray;function Oe(e){return null!=e&&xe(e.length)&&!ze(e)}var Ae=C||function(){return!1};function ze(e){if(!Ee(e))return!1;var t=ue(e);return t==i||"[object GeneratorFunction]"==t||"[object AsyncFunction]"==t||"[object Proxy]"==t}function xe(e){return"number"==typeof e&&e>-1&&e%1==0&&e<=n}function Ee(e){var t=typeof e;return null!=e&&("object"==t||"function"==t)}function Ke(e){return null!=e&&"object"==typeof e}var $e=b?function(e){return function(t){return e(t)}}(b):function(e){return Ke(e)&&xe(e.length)&&!!l[ue(e)]};function Ve(e){return Oe(e)?ee(e,!0):se(e)}var qe,Pe=(qe=function(e,t,r){fe(e,t,r)},de((function(e,t){var r=-1,n=t.length,o=n>1?t[n-1]:void 0,i=n>2?t[2]:void 0;for(o=qe.length>3&&"function"==typeof o?(n--,o):void 0,i&&function(e,t,r){if(!Ee(r))return!1;var n=typeof t;return!!("number"==n?Oe(r)&&ye(t,r.length):"string"==n&&t in r)&&me(r[t],e)}(t[0],t[1],i)&&(o=n<3?void 0:o,n=1),e=Object(e);++r<n;){var a=t[r];a&&qe(e,a,r,o)}return e})));function Ue(e){return e}e.exports=Pe},m(j={path:w,exports:{},require:function(e,t){return function(){throw new Error("Dynamic requires are not currently supported by @rollup/plugin-commonjs")}(null==t&&j.path)}},j.exports),j.exports);const A="normal",z="slow",x="rate",E="volume",K=f("forced_setting"),$=e=>i(e)&&!!e[K],V=e=>e.value,q=e=>({[K]:!0,value:e}),P=(e,t)=>x===e&&n(t)||E===e&&t>=0&&t<=1,U=(e,t)=>((e,t,r,n=1)=>{if(!i(e))return;const o=f(`${t}_override_version`);n>(Number(e[o])||0)&&Object.defineProperty(e,t,r(Object.getOwnPropertyDescriptor(e,t)))})(HTMLMediaElement,t,(t=>({...t,set:function(r){const o=M[e];n(r)?(this[o.originalValueKey]=r,u(this,o.valueKey)&&(r=this[o.isRelativeKey]?S(e,r*this[o.valueKey]):this[o.valueKey])):$(r)&&(r=V(r)),n(r)&&(this[o.listenerValueKey]=r),t.set.call(this,r)}}))),k=(e,t)=>y("Howl",t,(r=>function(){const n=this,o=arguments,i=M[e];let a=!1;const c=n._queue.length;(1===o.length||2===o.length&&void 0===o[1])&&-1===n._getSoundIds().indexOf(o[0])&&($(o[0])?(a=!0,o[0]=V(o[0])):P(e,o[0])&&(n[i.originalValueKey]=o[0],u(n,i.valueKey)&&(a=!0,n[i.isRelativeKey]?o[0]=S(e,o[0]*n[i.valueKey]):o[0]=n[i.valueKey])),a&&(n[i.listenerValueKey]=o[0]));const l=r.apply(n,arguments);return a&&c<n._queue.length&&(n._queue[n._queue.length-1].action=function(){o[0]=q(o[0]),n[t](...o)}),l})),T=(e,t,r,n)=>({...n,functions:{audio:{applyOverride:()=>U(e,r),getter:e=>e[t],setter:(e,r)=>e[t]=r,hasQueuedUpdate:()=>!1},howler:{applyOverride:()=>k(e,r),getter:e=>e[r](),setter:(e,t)=>e[r](t),hasQueuedUpdate:e=>e._queue.find((e=>e.event===r))}},priorityKey:f(`${e}_priority`),isRelativeKey:f(`${e}_is_relative`),valueKey:f(`forced_${e}_value`),originalValueKey:f(`original_${e}_value`),listenerValueKey:f(`${e}_value`)}),M={[x]:T(x,"playbackRate","rate",{minValue:.5,maxValue:4,defaultValue:1}),[E]:T(E,"volume","volume",{minValue:0,maxValue:1,defaultValue:1})},R=e=>(e=>{const t=M[e];if(!t)throw new Error(`Unknown sound setting: "${e}".`);return t})(e).defaultValue,S=(e,t)=>M[e]?Math.max(M[e].minValue,Math.min(t,M[e].maxValue)):t,I=["listening_challenge","other_challenge","story","forum_discussion","dictionary","unknown"],F="default",B="main",L=[E,x],N=e=>E===e,C=(e,t=null,r=null)=>({effect:{[A]:t},tts_sentence:{[A]:t,[z]:t},tts_word:{[A]:t,[z]:t},unknown:{[A]:t},...N(e)?{[B]:r}:{}}),D=(e,t)=>Object.fromEntries([[F,C(e,{value:t,isRelative:!0},{value:t})],...I.map((t=>[t,C(e)]))]),H=Object.fromEntries(L.map((e=>[e,D(e,R(e))]))),Q=(e,t,r,n,o,a)=>{return u=r,c=n,i(H.volume.default[u][c])?O({},e,{[t]:{[null!=o?o:F]:{[r]:{[n]:a}}}}):e;var u,c},G=e=>L.includes(e.setting)&&u(e,"value")&&(!e.context||I.includes(e.context)),W=(e,t)=>{if(!G(t))return e;const{setting:r,context:n,value:o,soundType:i=null,soundSpeed:a=null}=t;return i&&a?Q(e,r,i,a,n,o):((e,t,r,n)=>N(t)?O({},e,{[t]:{[null!=r?r:F]:{[B]:n}}}):e)(e,r,n,o)},J="profiles",X=async(e,r)=>{if(i(e)&&i(e.updateRequest)&&G(e.updateRequest)){const i=(await t.get(J)).profiles||{};i[0]=W(i[0]||H,e.updateRequest),await t.set({[J]:i}),r(i[0]),n="current_profile_changed",o=i[0],chrome.runtime.sendMessage({type:b,event:n,value:o}),chrome.tabs.query({url:"https://*.duolingo.com/*"},(e=>e.forEach((e=>chrome.tabs.sendMessage(e.id,{type:b,event:n,value:o})))))}var n,o};var Y;Y=async(e,r,n,o)=>{switch(e){case"get_current_profile":await(async e=>{const r=(await t.get(J)).profiles||{};e((null==r?void 0:r[0])||H)})(o);break;case"update_current_profile":await X(r,o)}},chrome.runtime.onMessage.addListener(((e,t,r)=>{if(_===e.type){let n=!1;const o=e=>{n=!0,r({type:"success",value:e})},i=e=>{n=!0,r({type:"failure",error:e})};try{Promise.resolve(Y(e.action,e.value,t,o,i)).then((()=>{if(!n)throw new Error(`Could not handle action request: "${e.action}".`)})).catch((e=>{n||i(e)}))}catch(e){!n&&i(e)}return!0}})),chrome.tabs.onUpdated.addListener(((e,t)=>e&&(null!=t&&t.id?l(t):s(e,l)))),chrome.tabs.onActivated.addListener((({tabId:e})=>e&&s(e,l)))}();
